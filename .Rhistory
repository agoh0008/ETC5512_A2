joined_map_2021 %>%
filter(!is.na(Elect_div), Average_household_size > 0, Median_tot_hhd_inc_weekly > 0) %>%
ggplot(aes(x = Average_household_size, y = Median_tot_hhd_inc_weekly, col = Elect_div)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = "Average household size", y = "Median weekly total household income") +
facet_grid(rows = vars(electorate_type))
library(sessioninfo)
sessioninfo::session_info()
View(enrolment_vic)
View(SA1_2021_G02)
census2021 <- joined_map_2021[, c("Median_mortgage_repay_monthly", "Median_rent_weekly", "Median_tot_hhd_inc_weekly", "Elect_div")]
mean_census <- as.data.frame(census2021) %>%
select(Elect_div, Median_mortgage_repay_monthly, Median_rent_weekly, Median_tot_hhd_inc_weekly) %>%
filter(!is.na(Elect_div))
mean_census_df <- mean_census %>%
group_by(Elect_div) %>%
summarize(
Mean_Median_mortgage_repay_monthly = mean(Median_mortgage_repay_monthly, na.rm = TRUE),
Mean_Median_rent_weekly = mean(Median_rent_weekly, na.rm = TRUE),
Mean_Median_tot_hhd_inc_weekly = mean(Median_tot_hhd_inc_weekly, na.rm = TRUE)
)
mean_census_melbourne <- mean_census_df %>%
filter(Elect_div == "Melbourne")
caption <- "For Melbourne, we estimate that the average median monthly mortgage repayments is $2054, with the average median weekly rent being $423 and the average median total household income being $1937 (rounded up to 2 decimal points)."
mean_census_melbourne %>% kable(col.names = c("Elect_div", "Mean_Median_mortgage_repay_monthly",
"Mean_Median_rent_weekly", "Mean_Median_tot_hhd_inc_weekly"),
caption = caption) %>%
kable_styling(bootstrap_options = c("striped", "hover"))
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(sf)
library(ggplot2)
library(dplyr)
library(knitr)
library(kableExtra)
election2022 <- read_csv("https://results.aec.gov.au/27966/Website/Downloads/HouseDopByDivisionDownload-27966.csv", skip = 1) %>%
filter(StateAb == "VIC")
vic_marginal <- election2022 %>%
group_by(DivisionNm) %>%
filter(CalculationType == "Preference Percent" &
CountNumber == max(CountNumber) &
Elected == "Y" &
CalculationValue <56)
vic_marginal
vic_map <- read_sf(here::here("vic-july-2021-esri/E_VIC21_region.shp")) %>%
mutate(DivisionNm = (Elect_div)) %>%
st_crop(xmin = 100, xmax = 155.2,
ymin = -50.1, ymax = -30.6)
party_colors <- c(
"ALP" = "#DE3533", "LNP" = "#ADD8E6",
"KAP" = "#8B0000", "GRN" = "#10C25B",
"GVIC" = "#10C25B", "XEN" = "#ff6300",
"LP" = "#0047AB", "NP" = "#0a9cca",
"IND" = "#000000"
)
vic_map <- st_zm(vic_map) %>%
left_join(vic_marginal, by = "DivisionNm")
vic_labels <- vic_map %>%
filter(DivisionNm %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong",
"McEwen", "Menzies", "Monash", "Nicholls", "Wannon")) %>%
st_centroid()
ggplot(vic_map) +
geom_sf(aes(geometry = geometry, fill = PartyAb),
color = "white") +
geom_sf_text(data = vic_labels,
aes(label = "â€¢"),
size = 3, color = "black") +
scale_fill_manual(values = party_colors) +
labs(title = "Marginal Electorates in Victoria",
subtitle = "Federal Election 2022",
fill = "Winning Party")
enrolment_vic <- read_csv("https://results.aec.gov.au/27966/Website/Downloads/GeneralEnrolmentByDivisionDownload-27966.csv", skip = 1) %>%
filter(StateAb == "VIC") %>%
filter(DivisionNm %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong",
"McEwen", "Menzies", "Monash", "Nicholls", "Wannon"))
enrolment_vic <- enrolment_vic %>%
select(DivisionNm, Enrolment)
enrolment_vic_table <- enrolment_vic %>%
kable(caption = "Number of Voters Currently Enrolled in Victorian Marginal Seats", align = "c") %>%
kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover"))
enrolment_vic_table
SA1_2016 <- read_sf(here::here("Geopackage_2016_EIUWA_for_VIC/census2016_eiuwa_vic_short.gpkg"),
layer = "census2016_eiuwa_vic_sa1_short")
SA1_2021_G02 <- read_sf(here::here("Geopackage_2021_G02_VIC_GDA2020/G02_VIC_GDA2020.gpkg"),
layer = "G02_SA1_2021_VIC")
rent_2016hist <- ggplot(SA1_2016, aes(x = Median_rent_weekly)) +
geom_histogram(binwidth = 20, fill = "steelblue") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Rents in 2016") +
xlab("Median Rent (Weekly)") +
ylab("Count")
rent_2016hist
rent_2021hist <- ggplot(SA1_2021_G02, aes(x = Median_rent_weekly)) +
geom_histogram(binwidth = 20, fill = "red") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Rents in 2021") +
xlab("Median Rent (Weekly)") +
ylab("Count")
rent_2021hist
income_2016hist <- ggplot(SA1_2016, aes(x = Median_tot_hhd_inc_weekly)) +
geom_histogram(binwidth = 50, fill = "steelblue") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Household Incomes in 2016") +
xlab("Median Household Income (Weekly)") +
ylab("Count")
income_2016hist
income_2021hist <- ggplot(SA1_2021_G02, aes(x = Median_tot_hhd_inc_weekly)) +
geom_histogram(binwidth = 50, fill = "red") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Household Incomes in 2021") +
xlab("Median Household Income (Weekly)") +
ylab("Count")
income_2021hist
joined_map_2016 <- st_join(st_centroid(SA1_2016), vic_map) %>%
st_join(SA1_2016 %>% select(sa1_7digitcode_2016), .)
ggplot(data = joined_map_2016) +
geom_sf(aes(geometry = geom, fill = Elect_div)) +
geom_sf(data = vic_map,
aes(geometry = geometry), col = "red", fill = "transparent")
# Reproject SA1_2021_G02 to match the CRS of vic_map
SA1_2021_G02_reproj <- st_transform(SA1_2021_G02, st_crs(vic_map))
# Perform the join operation
joined_map_2021 <- st_join(st_centroid(SA1_2021_G02_reproj), vic_map) %>%
st_join(SA1_2021_G02_reproj %>% select(SA1_CODE_2021), .)
# Plot the map
ggplot(data = joined_map_2021) +
geom_sf(aes(geometry = geom, fill = Elect_div)) +
geom_sf(data = vic_map,
aes(geometry = geometry), col = "red", fill = "transparent")
# Number of SA1 regions in Melbourne electorate based on 2021 census data:
n_distinct(joined_map_2021$SA1_CODE_2021.x[joined_map_2021$Elect_div == "Melbourne"])
# Number of SA1 regions in Melbourne electorate based on 2016 census data:
n_distinct(joined_map_2016$sa1_7digitcode_2016.x[joined_map_2016$Elect_div == "Melbourne"])
census2021 <- joined_map_2021[, c("Median_mortgage_repay_monthly", "Median_rent_weekly", "Median_tot_hhd_inc_weekly", "Elect_div")]
mean_census <- as.data.frame(census2021) %>%
select(Elect_div, Median_mortgage_repay_monthly, Median_rent_weekly, Median_tot_hhd_inc_weekly) %>%
filter(!is.na(Elect_div))
mean_census_df <- mean_census %>%
group_by(Elect_div) %>%
summarize(
Mean_Median_mortgage_repay_monthly = mean(Median_mortgage_repay_monthly, na.rm = TRUE),
Mean_Median_rent_weekly = mean(Median_rent_weekly, na.rm = TRUE),
Mean_Median_tot_hhd_inc_weekly = mean(Median_tot_hhd_inc_weekly, na.rm = TRUE)
)
mean_census_melbourne <- mean_census_df %>%
filter(Elect_div == "Melbourne")
caption <- "For Melbourne, we estimate that the average median monthly mortgage repayments is $2054, with the average median weekly rent being $423 and the average median total household income being $1937 (rounded up to 2 decimal points)."
mean_census_melbourne %>% kable(col.names = c("Elect_div", "Mean_Median_mortgage_repay_monthly",
"Mean_Median_rent_weekly", "Mean_Median_tot_hhd_inc_weekly"),
caption = caption) %>%
kable_styling(bootstrap_options = c("striped", "hover"))
joined_map_2021 <- joined_map_2021 %>%
mutate(centroid = st_centroid(geom))
ggplot(data = joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Median_tot_prsnl_inc_weekly), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Median weekly\npersonal income", option = "viridis") +
coord_sf(xlim = c(144.7, 145.8), ylim = c(-38.2, -37.6))
SA1_2021_G43 <- read_sf(here::here("Geopackage_2021_G43_VIC_GDA2020/G43_VIC_GDA2020.gpkg"),
layer = "G43_SA1_2021_VIC")
SA1_2021_G43_reproj <- st_transform(SA1_2021_G43, st_crs(vic_map))
new_joined_map_2021 <- st_join(st_centroid(SA1_2021_G43_reproj), vic_map) %>%
st_join(SA1_2021_G43_reproj %>% select(SA1_CODE_2021), .)
new_joined_map_2021 <- new_joined_map_2021 %>%
mutate(centroid = st_centroid(geom))
ggplot(data = new_joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Percent_Unem_loyment_P), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Unemployment Rate (%)", option = "inferno") +
coord_sf(xlim = c(144.8, 145.4), ylim = c(-38, -37.6))
ggplot(data = filter(new_joined_map_2021, Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(x = Elect_div,
y = non_sch_qual_Bchelr_Degree_P,
fill = Elect_div)) +
geom_boxplot() +
scale_fill_brewer(palette = "Set3") +
labs(x = "Electorate Division",
y = "# of People Holding a Bachelor's Degree")
ggplot(data = joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Median_mortgage_repay_monthly), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Median monthly\nmortgage repayments", option = "plasma") +
coord_sf(xlim = c(144.9, 145.4), ylim = c(-38, -37.7))
mean_census_df <- mean_census_df %>%
mutate(electorate_type = ifelse(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon"), "Marginal Electorate", "Non-marginal Electorate"))
mean_census_df %>%
filter(!is.na(Elect_div), Mean_Median_tot_hhd_inc_weekly > 0, Mean_Median_rent_weekly > 0) %>%
ggplot(aes(x = Mean_Median_tot_hhd_inc_weekly, y = Mean_Median_rent_weekly, col = Elect_div)) +
geom_point(size = 2) +
scale_color_viridis_d() +
labs(x = "Average weekly total household income", y = "Average weekly rent") +
facet_grid(cols = vars(electorate_type))
joined_map_2021 <- joined_map_2021 %>%
mutate(electorate_type = ifelse(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon"), "Marginal Electorate", "Non-marginal Electorate"))
joined_map_2021 %>%
filter(!is.na(Elect_div), Average_household_size > 0, Median_tot_hhd_inc_weekly > 0) %>%
ggplot(aes(x = Average_household_size, y = Median_tot_hhd_inc_weekly, col = Elect_div)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = "Average household size", y = "Median weekly total household income") +
facet_grid(rows = vars(electorate_type))
library(sessioninfo)
sessioninfo::session_info()
read_sf(here::here("Geopackage_2016_EIUWA_for_VIC/census2016_eiuwa_vic_short.gpkg"),
layer = "census2016_eiuwa_vic_sa1_short")
read_sf(here::here("Geopackage_2016_EIUWA_for_VIC/census2016_eiuwa_vic_short.gpkg"),
layer = "census2016_eiuwa_vic_sa1_short")
SA1_2016 <- read_sf(here::here("Geopackage_2016_EIUWA_for_VIC/census2016_eiuwa_vic_short.gpkg"),
layer = "census2016_eiuwa_vic_sa1_short")
SA1_2021_G02 <- read_sf(here::here("Geopackage_2021_G02_VIC_GDA2020/G02_VIC_GDA2020.gpkg"),
layer = "G02_SA1_2021_VIC")
SA1_2016 <- read_sf(here::here("Geopackage_2016_EIUWA_for_VIC/census2016_eiuwa_vic_short.gpkg"),
layer = "census2016_eiuwa_vic_sa1_short")
SA1_2016 <- read_sf(here::here("data/Geopackage_2016_EIUWA_for_VIC/census2016_eiuwa_vic_short.gpkg"),
layer = "census2016_eiuwa_vic_sa1_short")
SA1_2021_G02 <- read_sf(here::here("data/Geopackage_2021_G02_VIC_GDA2020/G02_VIC_GDA2020.gpkg"),
layer = "G02_SA1_2021_VIC")
SA1_2021_G43 <- read_sf(here::here("data/Geopackage_2021_G43_VIC_GDA2020/G43_VIC_GDA2020.gpkg"),
layer = "G43_SA1_2021_VIC")
SA1_2021_G43_reproj <- st_transform(SA1_2021_G43, st_crs(vic_map))
new_joined_map_2021 <- st_join(st_centroid(SA1_2021_G43_reproj), vic_map) %>%
st_join(SA1_2021_G43_reproj %>% select(SA1_CODE_2021), .)
new_joined_map_2021 <- new_joined_map_2021 %>%
mutate(centroid = st_centroid(geom))
ggplot(data = new_joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Percent_Unem_loyment_P), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Unemployment Rate (%)", option = "inferno") +
coord_sf(xlim = c(144.8, 145.4), ylim = c(-38, -37.6))
SA1_2021_G43 <- read_sf(here::here("data/Geopackage_2021_G43_VIC_GDA2020/G43_VIC_GDA2020.gpkg"),
layer = "G43_SA1_2021_VIC")
SA1_2021_G43_reproj <- st_transform(SA1_2021_G43, st_crs(vic_map))
new_joined_map_2021 <- st_join(st_centroid(SA1_2021_G43_reproj), vic_map) %>%
st_join(SA1_2021_G43_reproj %>% select(SA1_CODE_2021), .)
new_joined_map_2021 <- new_joined_map_2021 %>%
mutate(centroid = st_centroid(geom))
ggplot(data = new_joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Percent_Unem_loyment_P), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Unemployment Rate (%)", option = "inferno") +
coord_sf(xlim = c(144.8, 145.4), ylim = c(-38, -37.6))
vic_map <- read_sf(here::here("vic-july-2021-esri/E_VIC21_region.shp")) %>%
mutate(DivisionNm = (Elect_div)) %>%
st_crop(xmin = 100, xmax = 155.2,
ymin = -50.1, ymax = -30.6)
vic_map <- read_sf(here::here("data/vic-july-2021-esri/E_VIC21_region.shp")) %>%
mutate(DivisionNm = (Elect_div)) %>%
st_crop(xmin = 100, xmax = 155.2,
ymin = -50.1, ymax = -30.6)
party_colors <- c(
"ALP" = "#DE3533", "LNP" = "#ADD8E6",
"KAP" = "#8B0000", "GRN" = "#10C25B",
"GVIC" = "#10C25B", "XEN" = "#ff6300",
"LP" = "#0047AB", "NP" = "#0a9cca",
"IND" = "#000000"
)
vic_map <- read_sf(here::here("data/vic-july-2021-esri/E_VIC21_region.shp")) %>%
mutate(DivisionNm = (Elect_div)) %>%
st_crop(xmin = 100, xmax = 155.2,
ymin = -50.1, ymax = -30.6)
party_colors <- c(
"ALP" = "#DE3533", "LNP" = "#ADD8E6",
"KAP" = "#8B0000", "GRN" = "#10C25B",
"GVIC" = "#10C25B", "XEN" = "#ff6300",
"LP" = "#0047AB", "NP" = "#0a9cca",
"IND" = "#000000"
)
ggplot(data = filter(new_joined_map_2021, Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(x = Elect_div,
y = non_sch_qual_Bchelr_Degree_P,
fill = Elect_div)) +
geom_boxplot() +
scale_fill_brewer(palette = "Set3") +
labs(x = "Electorate Division",
y = "# of People Holding a Bachelor's Degree") +
scale_x_discrete(labels = c("Elect_div" = "Marginal Electorate Divisions"))
ggplot(data = filter(new_joined_map_2021, Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(x = Elect_div,
y = non_sch_qual_Bchelr_Degree_P,
fill = Elect_div)) +
geom_boxplot() +
scale_fill_brewer(palette = "Set3") +
labs(x = "Electorate Division",
y = "# of People Holding a Bachelor's Degree".
ggplot(data = filter(new_joined_map_2021, Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(x = Elect_div,
y = non_sch_qual_Bchelr_Degree_P,
fill = Elect_div)) +
geom_boxplot() +
scale_fill_brewer(palette = "Set3") +
labs(x = "Electorate Division",
y = "# of People Holding a Bachelor's Degree",
fill = "Marginal Electorate Divisions")
ggplot(data = filter(new_joined_map_2021, Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(x = Elect_div,
y = non_sch_qual_Bchelr_Degree_P,
fill = Elect_div)) +
geom_boxplot() +
scale_fill_brewer(palette = "Set3") +
labs(x = "Electorate Division",
y = "# of People Holding a Bachelor's Degree",
fill = "Marginal Electorate Divisions") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(sf)
library(ggplot2)
library(dplyr)
library(knitr)
library(kableExtra)
election2022 <- read_csv("https://results.aec.gov.au/27966/Website/Downloads/HouseDopByDivisionDownload-27966.csv", skip = 1) %>%
filter(StateAb == "VIC")
vic_marginal <- election2022 %>%
group_by(DivisionNm) %>%
filter(CalculationType == "Preference Percent" &
CountNumber == max(CountNumber) &
Elected == "Y" &
CalculationValue <56)
vic_marginal
vic_map <- read_sf(here::here("data/vic-july-2021-esri/E_VIC21_region.shp")) %>%
mutate(DivisionNm = (Elect_div)) %>%
st_crop(xmin = 100, xmax = 155.2,
ymin = -50.1, ymax = -30.6)
party_colors <- c(
"ALP" = "#DE3533", "LNP" = "#ADD8E6",
"KAP" = "#8B0000", "GRN" = "#10C25B",
"GVIC" = "#10C25B", "XEN" = "#ff6300",
"LP" = "#0047AB", "NP" = "#0a9cca",
"IND" = "#000000"
)
vic_map <- st_zm(vic_map) %>%
left_join(vic_marginal, by = "DivisionNm")
vic_labels <- vic_map %>%
filter(DivisionNm %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong",
"McEwen", "Menzies", "Monash", "Nicholls", "Wannon")) %>%
st_centroid()
ggplot(vic_map) +
geom_sf(aes(geometry = geometry, fill = PartyAb),
color = "white") +
geom_sf_text(data = vic_labels,
aes(label = "â€¢"),
size = 3, color = "black") +
scale_fill_manual(values = party_colors) +
labs(title = "Marginal Electorates in Victoria",
subtitle = "Federal Election 2022",
fill = "Winning Party")
enrolment_vic <- read_csv("https://results.aec.gov.au/27966/Website/Downloads/GeneralEnrolmentByDivisionDownload-27966.csv", skip = 1) %>%
filter(StateAb == "VIC") %>%
filter(DivisionNm %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong",
"McEwen", "Menzies", "Monash", "Nicholls", "Wannon"))
enrolment_vic <- enrolment_vic %>%
select(DivisionNm, Enrolment)
enrolment_vic_table <- enrolment_vic %>%
kable(caption = "Number of Voters Currently Enrolled in Victorian Marginal Seats", align = "c") %>%
kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover"))
enrolment_vic_table
load(here::here("data/Geopackage_2016_EIUWA_for_VIC.rda"))
load(here::here("data/Geopackage_2021_G02_VIC_GDA2020.rda"))
rent_2016hist <- ggplot(SA1_2016, aes(x = Median_rent_weekly)) +
geom_histogram(binwidth = 20, fill = "steelblue") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Rents in 2016") +
xlab("Median Rent (Weekly)") +
ylab("Count")
rent_2016hist
rent_2021hist <- ggplot(SA1_2021_G02, aes(x = Median_rent_weekly)) +
geom_histogram(binwidth = 20, fill = "red") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Rents in 2021") +
xlab("Median Rent (Weekly)") +
ylab("Count")
rent_2021hist
income_2016hist <- ggplot(SA1_2016, aes(x = Median_tot_hhd_inc_weekly)) +
geom_histogram(binwidth = 50, fill = "steelblue") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Household Incomes in 2016") +
xlab("Median Household Income (Weekly)") +
ylab("Count")
income_2016hist
income_2021hist <- ggplot(SA1_2021_G02, aes(x = Median_tot_hhd_inc_weekly)) +
geom_histogram(binwidth = 50, fill = "red") +
scale_fill_brewer(palette = "Set1") +
ggtitle("Distribution of Weekly Household Incomes in 2021") +
xlab("Median Household Income (Weekly)") +
ylab("Count")
income_2021hist
joined_map_2016 <- st_join(st_centroid(SA1_2016), vic_map) %>%
st_join(SA1_2016 %>% select(sa1_7digitcode_2016), .)
ggplot(data = joined_map_2016) +
geom_sf(aes(geometry = geom, fill = Elect_div)) +
geom_sf(data = vic_map,
aes(geometry = geometry), col = "red", fill = "transparent")
# Reproject SA1_2021_G02 to match the CRS of vic_map
SA1_2021_G02_reproj <- st_transform(SA1_2021_G02, st_crs(vic_map))
# Perform the join operation
joined_map_2021 <- st_join(st_centroid(SA1_2021_G02_reproj), vic_map) %>%
st_join(SA1_2021_G02_reproj %>% select(SA1_CODE_2021), .)
# Plot the map
ggplot(data = joined_map_2021) +
geom_sf(aes(geometry = geom, fill = Elect_div)) +
geom_sf(data = vic_map,
aes(geometry = geometry), col = "red", fill = "transparent")
# Number of SA1 regions in Melbourne electorate based on 2021 census data:
n_distinct(joined_map_2021$SA1_CODE_2021.x[joined_map_2021$Elect_div == "Melbourne"])
# Number of SA1 regions in Melbourne electorate based on 2016 census data:
n_distinct(joined_map_2016$sa1_7digitcode_2016.x[joined_map_2016$Elect_div == "Melbourne"])
census2021 <- joined_map_2021[, c("Median_mortgage_repay_monthly", "Median_rent_weekly", "Median_tot_hhd_inc_weekly", "Elect_div")]
mean_census <- as.data.frame(census2021) %>%
select(Elect_div, Median_mortgage_repay_monthly, Median_rent_weekly, Median_tot_hhd_inc_weekly) %>%
filter(!is.na(Elect_div))
mean_census_df <- mean_census %>%
group_by(Elect_div) %>%
summarize(
Mean_Median_mortgage_repay_monthly = mean(Median_mortgage_repay_monthly, na.rm = TRUE),
Mean_Median_rent_weekly = mean(Median_rent_weekly, na.rm = TRUE),
Mean_Median_tot_hhd_inc_weekly = mean(Median_tot_hhd_inc_weekly, na.rm = TRUE)
)
mean_census_melbourne <- mean_census_df %>%
filter(Elect_div == "Melbourne")
caption <- "For Melbourne, we estimate that the average median monthly mortgage repayments is $2054, with the average median weekly rent being $423 and the average median total household income being $1937 (rounded up to 2 decimal points)."
mean_census_melbourne %>% kable(col.names = c("Elect_div", "Mean_Median_mortgage_repay_monthly",
"Mean_Median_rent_weekly", "Mean_Median_tot_hhd_inc_weekly"),
caption = caption) %>%
kable_styling(bootstrap_options = c("striped", "hover"))
joined_map_2021 <- joined_map_2021 %>%
mutate(centroid = st_centroid(geom))
ggplot(data = joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Median_tot_prsnl_inc_weekly), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Median weekly\npersonal income", option = "viridis") +
coord_sf(xlim = c(144.7, 145.8), ylim = c(-38.2, -37.6))
load(here::here("data/Geopackage_2021_G43_VIC_GDA2020.rda"))
SA1_2021_G43_reproj <- st_transform(SA1_2021_G43, st_crs(vic_map))
new_joined_map_2021 <- st_join(st_centroid(SA1_2021_G43_reproj), vic_map) %>%
st_join(SA1_2021_G43_reproj %>% select(SA1_CODE_2021), .)
new_joined_map_2021 <- new_joined_map_2021 %>%
mutate(centroid = st_centroid(geom))
ggplot(data = new_joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Percent_Unem_loyment_P), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Unemployment Rate (%)", option = "inferno") +
coord_sf(xlim = c(144.8, 145.4), ylim = c(-38, -37.6))
ggplot(data = filter(new_joined_map_2021, Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(x = Elect_div,
y = non_sch_qual_Bchelr_Degree_P,
fill = Elect_div)) +
geom_boxplot() +
scale_fill_brewer(palette = "Set3") +
labs(x = "Electorate Division",
y = "# of People Holding a Bachelor's Degree",
fill = "Marginal Electorate Divisions") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data = joined_map_2021) +
geom_sf(aes(geometry = centroid, color = Median_mortgage_repay_monthly), shape = 3) +
geom_sf(data = vic_map,
aes(geometry = geometry),fill = "transparent", size = 1.3, color = "black") +
geom_sf_label(data = vic_map %>% filter(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon")),
aes(geometry = geometry, label = Elect_div), size = 2, fontface = "bold") +
scale_color_viridis_c(name = "Median monthly\nmortgage repayments", option = "plasma") +
coord_sf(xlim = c(144.9, 145.4), ylim = c(-38, -37.7))
mean_census_df <- mean_census_df %>%
mutate(electorate_type = ifelse(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon"), "Marginal Electorate", "Non-marginal Electorate"))
mean_census_df %>%
filter(!is.na(Elect_div), Mean_Median_tot_hhd_inc_weekly > 0, Mean_Median_rent_weekly > 0) %>%
ggplot(aes(x = Mean_Median_tot_hhd_inc_weekly, y = Mean_Median_rent_weekly, col = Elect_div)) +
geom_point(size = 2) +
scale_color_viridis_d() +
labs(x = "Average weekly total household income", y = "Average weekly rent") +
facet_grid(cols = vars(electorate_type))
joined_map_2021 <- joined_map_2021 %>%
mutate(electorate_type = ifelse(Elect_div %in% c("Aston", "Casey", "Deakin", "Goldstein", "Higgins", "Kooyong", "McEwen", "Menzies", "Monash", "Nicholls", "Wannon"), "Marginal Electorate", "Non-marginal Electorate"))
joined_map_2021 %>%
filter(!is.na(Elect_div), Average_household_size > 0, Median_tot_hhd_inc_weekly > 0) %>%
ggplot(aes(x = Average_household_size, y = Median_tot_hhd_inc_weekly, col = Elect_div)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = "Average household size", y = "Median weekly total household income") +
facet_grid(rows = vars(electorate_type))
library(tidyverse)
library(sf)
library(ggplot2)
library(dplyr)
library(knitr)
library(kableExtra)
library(sessioninfo)
sessioninfo::session_info()
